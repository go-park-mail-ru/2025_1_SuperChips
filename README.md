# 2025_1_SuperChips

[Deploy](https://yourflow.ru/)

# Послание от бэкенд разработчика из прошлого бэкенд разработчику из будущего

> Зайдя в репозиторий через пол года, вы вряд ли вспомните, что вы вообще писали.

Именно поэтому я оставляю здесь эти записи, чтобы у вас была возможность разобраться в том, что здесь происходит.

Конечно, записи не расскажут о всём, но если вы сюда полезли, значит вы понимаете, что делаете.

# Какие утилиты необходимы для разработки

1. Необходимо скачать Docker, Golang, Git.
2. Для работы с gRPC: https://grpc.io/docs/languages/go/quickstart/#prerequisites
3. Утилита для миграций: https://github.com/golang-migrate/migrate/tree/master/cmd/migrate
4. Утилита для моков: https://github.com/uber-go/mock
5. Утилита для документации: https://github.com/swaggo/swag
6. Утилита для easyjson: https://github.com/mailru/easyjson

# Утилита не работает или не скачивается?

Проверьте, что установлены переменные окружения PATH и GOPATH:
```
export GOPATH=$HOME/go
export PATH=$PATH:$GOPATH/bin
```

# Тестирование API

Мне пока что не удалось найти бесплатный инструмент, который удовлетворял бы необходимым требованиям: бесплатный, НЕоблачный, с интерфейсом, со скриптингом, с авто тестированием сценариев.

Postman и Insomnia лично я не использую, так как они работают через облако.
Лично я использую Bruno для ручного тестирования. Коллекцию можно легко создать из ./docs/swagger.json.
TODO: Автоматическое тестирование сценариев.

# Если вдруг захочется доработать API

Предварительно:
-- Определиться с назначением API.
-- Примерно накидать ручки, URL'ы, параметры и результаты. Сразу точно всё продумать не получится, абсолютная ясность придёт в процессе разработки и тестирования.

В файле приложения:
-- Подключить ручки. В файле лежит закомментированный шаблон, которым стоит воспользоваться.
-- Создать хендлер, объекты сервиса и репозитория.

Работа на rest-слое:
-- Лучше писать каждую ручку в отдельном файле. Ручки одного хендлера складывать в одну папку.
-- В ручке есть несколько основных стадий:
-- -- Получение параметров запроса из URL'а, анмаршелинг тела запроса или парсинг формы.
-- -- Извлечение данных авторизации - ID пользователя.
-- -- Валидация данных с помощью валидатора.
-- -- Обращение к слою бизнес логики.
-- -- Применение защиты от XSS, если это необходимо.
-- -- Формирование ответа.

Работа с документацией:
-- Написать документацию к каждой ручке на rest-слое в формате OpenAPI.
-- Поправить оформление - прописать `swag fmt`.
-- Сгенерировать документацию - прописать `swag -d ./domain,./internal/rest`.
-- Проверить, что документация нормально сгенерировалась и нет ошибок - запустить `go run ./app/doc`.
-- Повторять предыдущие шаги пока документация не будет готова.